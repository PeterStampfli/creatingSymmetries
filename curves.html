<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8"/>
<head>
	<title>curves</title>
</head>
<body>
	<noscript>
		<h1 style="background-color:orange">
			Please allow execution of javascript !
			<br>
			(Else nothing happens.)
		</h1>
	</noscript>
	<h2>
		Change the code of this page to create your own symmetric curves!
	</h2>
	<p>
		To "download" this image 
		<a id="downloadImageButton" href="">&nbsp click here ! &nbsp</a>
	</p>
	<p>
		To download the code of this page for doing your own work
		<a download href="curves.html">&nbsp click here ! &nbsp</a>
	</p>
	<p>
		<canvas id="outputCanvas" moz-opaque></canvas>
	</p>

</body>
<script>
var canvas;
var canvasImage;

// setting up the canvas, its context and line stayles
window.onload = function () {
	setupImageDownload();
    canvas = document.getElementById("outputCanvas");
    canvasImage = canvas.getContext("2d");
    canvas.height=size;
    canvas.width=size;
    canvasImage.fillStyle=backgroundColor;
    canvasImage.fillRect(0,0,size,size);
    canvasImage.lineJoin="round";
    canvasImage.lineCap="round";
    canvasImage.lineWidth=lineWidth;
	drawing();

};

// how to download the canvas image
function setupImageDownload(){
    var downloadImageButton = document.getElementById('downloadImageButton');
    //  for image downloading, using jpeg image format, default quality=0.92
    downloadImageButton.addEventListener('click', function () {
            //  use correct data format and filename
            downloadImageButton.href = outputCanvas.toDataURL("image/jpeg"); // the data URL is made at the time of the click
            downloadImageButton.download = "theImage.jpg";
        }, false);
}

//  this draws the curve using the special function z(t)
function drawing(){
	var tpi=2*Math.PI;
	var t=0;
	var dt=tpi/nSteps;
	canvasImage.beginPath();
	updateZ(0);
	canvasImage.moveTo(scale*z.re+size/2,scale*z.im+size/2);
	while (t<=tpi){
		t+=dt;
		updateZ(t);
		canvasImage.lineTo(scale*z.re+size/2,scale*z.im+size/2);
	}
	canvasImage.stroke();
}

var z=cZero();
	
/*
class: CNumber
a class for complex numbers
*/
function CNumber(re,im) {
    this.re = re;
    this.im = im;
}

//  create a new complex zero without "new"
function cZero() {
    return new CNumber(0,0);
}

//  create a new cNumber without "new"
function cNumber(re,im) {
    return new CNumber(re,im);
}

//  set a complex number equal to given real and imaginary components
CNumber.prototype.set=function(re,im) {
	this.re=re;
	this.im=im;
    return this;
};

//  multiply a complex number with a phase factor exp(i * phase)
CNumber.prototype.phase=function(phi){
	var cosPhi=Math.cos(phi);
	var sinPhi=Math.sin(phi);
	var h=this.re*cosPhi-this.im*sinPhi;
	this.im=this.re*sinPhi+this.im*cosPhi;
	this.re=h;
	return this;
};

// add to a complex number the product of another complex number tiomes a phase factor
// adds (re + i * im) * exp(i * phi) to the complex number
CNumber.prototype.add=function(re,im,phi){
	var cosPhi=Math.cos(phi);
	var sinPhi=Math.sin(phi);
	this.re+=re*cosPhi-im*sinPhi;
	this.im+=re*sinPhi+im*cosPhi;
	return this;
};

// parameters to define the general appearance of the curve

// the size of the image
var size=512;

// colors and line widths
var backgroundColor="rgb(200,200,150)";
var lineWidth=3;
var lineColor="rgb(0,0,150)";

// parameters for the curve

// the number of line segments
var nSteps=1000;

// a scale factor, adjust to fit the image on the canvas
var scale=0.2*size;

//  this is the special function z(t) that defines the curve
function updateZ(t){
	z.set(1,0).add(0.37,0.77,5*t).add(0,0.53,-15*t).phase(2*t);
}
</script>
</html>
